

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>IntGen &mdash; Ignition v0.1.0 documentation</title>
    <link rel="stylesheet" href="../static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <link rel="top" title="Ignition v0.1.0 documentation" href="../index.html" />
    <link rel="up" title="Tutorial" href="index.html" />
    <link rel="next" title="The FLAME Interface" href="flame.html" />
    <link rel="prev" title="What is a Domain Specific Language" href="dsl.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <h1><a href="../index.html">Ignition v0.1.0 documentation</a></h1>
        <div class="rel">
          <a href="dsl.html" title="What is a Domain Specific Language"
             accesskey="P">previous</a> |
          <a href="flame.html" title="The FLAME Interface"
             accesskey="N">next</a> |
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="intgen">
<h1>IntGen<a class="headerlink" href="#intgen" title="Permalink to this headline">¶</a></h1>
<p>To give a full example, let&#8217;s take numerical integration.  If a code uses an
integral with discrete and symbolic parts, there are huge gains if the code
evaluates the symbolic parts before they are run.  For example take the
following integral, where <img class="math" src="../images/math/4216c54b9c66ea6a2e02c7b59fb228bfbebc590b.png" alt="u(x)"/> comes from a discrete function in the code:</p>
<div class="math">
<p><img src="../images/math/60fe842f50aafd940c619dfccbee3d0c5a2250cd.png" alt="\int_0^1 (\cos(x)*u(x) + \sin(x) )*dx" /></p>
</div><p>A quick optimization would be to evaluate <img class="math" src="../images/math/a2162f5f60f63ebf73981676edba0d9055b5d99d.png" alt="\int sin(x)"/> and <img class="math" src="../images/math/bb5e108fdc4bf4fb6151cb922992f23bc6c35985.png" alt="\cos"/>
at the quadrature points, assuming two quadrature points, the new code would
be:</p>
<div class="math">
<p><img src="../images/math/0c05b6c49fb6526e15df30276ff953e08ff34e77.png" alt="0.45969769 + 0.48887694*u[0] + 0.35239291*u[1]" /></p>
</div><p>But that code is meaningless with out the formula above!  What&#8217;s more the user
has to evaluate the symbolic parts by hand which becomes yet another source of
error.  It would be better to have a high level code that generates the low
level code when a new integral (or even better precision) is required.</p>
<div class="section" id="using-intgen">
<h2>Using IntGen<a class="headerlink" href="#using-intgen" title="Permalink to this headline">¶</a></h2>
<p>In IntGen the above integral is translated into the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span> <span class="o">=</span> <span class="n">DiscFunc</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Dom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">integral</span> <span class="o">=</span> <span class="p">(</span><span class="n">Func</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">Func</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span>
<span class="n">select_quad_rule</span><span class="p">(</span><span class="n">num_pts</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;Gauss&quot;</span><span class="p">)</span>
<span class="n">gen_file</span><span class="p">(</span><span class="s">&quot;ex1&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">integral</span><span class="p">],</span>  <span class="p">[</span><span class="s">&quot;eval_gen&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;u&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>And the generated file that implements the integral would be:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">NUM_QUAD_PTS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">QUAD_PTS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mf">0.57735026919</span><span class="p">,</span> <span class="mf">0.57735026919</span><span class="p">};</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">QUAD_WTS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">};</span>

<span class="kr">inline</span> <span class="kt">double</span> <span class="nf">eval_gen</span><span class="p">(</span><span class="kt">double</span><span class="o">*</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">double</span> <span class="n">ret_val</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
  <span class="n">ret_val</span> <span class="o">+=</span> <span class="mf">0.459697694131860</span><span class="p">;</span>

  <span class="n">ret_val</span> <span class="o">+=</span> <span class="mf">0.488876937571022</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
          <span class="o">+</span> <span class="mf">0.352392910067197</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="k">return</span> <span class="n">ret_val</span><span class="p">;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>For the full example see <tt class="docutils literal"><span class="pre">demo/int_gen</span></tt>.</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../further_resources.html">Further Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">Ignition Modules Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="../search.html" method="get">
            <input type="text" name="q" size="18" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="dsl.html" title="What is a Domain Specific Language"
             >previous</a> |
          <a href="flame.html" title="The FLAME Interface"
             >next</a> |
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="../sources/tutorial/int_gen.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2010, Andy R. Terrel.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>
